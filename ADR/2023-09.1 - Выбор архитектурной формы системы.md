
**Дата:** 20 сентября 2023 г.

**Статус:** Принято

**Контекст:** 

При разработке платформы для управления рецептами мы стоим перед выбором архитектурной формы системы. Нам необходимо учесть масштабируемость, надежность, скорость разработки и возможность быстро вносить изменения.

При разработке системы поиска и резервирования билетов на концерты требуется создать платформу, обеспечивающую:
 - удобный интерфейс для пользователей и организаторов;
 - поддержку высокой нагрузки при пиковых продажах;
 - безопасность финансовых и персональных данных;
 - возможность быстрого добавления новых функций и интеграций.

Система должна быть масштабируемой, отказоустойчивой и готовой к развитию на горизонте 3–5 лет.

**Рассмотренные варианты:**

1. **Модульный монолит:** Единое приложение, разделенное на логические модули (авторизация, поиск концертов, билеты, платежи и т.д.).Компоненты взаимодействуют напрямую, без сетевого слоя.

    Плюсы:
    - Быстрая реализация и простота CI/CD.
    - Легче тестировать и отлаживать.
    - Меньше DevOps-нагрузка.

    Минусы:
    - Ограниченная масштабируемость.
    - Увеличение рисков с ростом функционала (взаимные зависимости, трудности с развертыванием).
    - Сложность при разделении по командам.

2. **Микросервисы:** Система разделена на отдельные сервисы, которые взаимодействуют между собой посредством API.

    Плюсы:
    - Высокая масштабируемость.
    - Независимое развертывание и обновление сервисов.
    - Повышенная устойчивость (сбой одного сервиса не останавливает всю систему).
    - Удобство для распределённой команды.

    Минусы:
    - Более сложная инфраструктура и DevOps-настройка.
    - Увеличенные накладные расходы на сетевое взаимодействие.
    - Требуется продуманная система логирования, мониторинга и оркестрации (Kubernetes).

3. **Серверлесс:** Использование облачных функций для отдельных операций, без постоянного управления серверами.

    Плюсы:
    - Масштабирование “по требованию”.
    - Минимальное обслуживание инфраструктуры.
    - Оплата только за фактическое использование.

    Минусы:
    - Зависимость от облачного провайдера.
    - Более высокая латентность при "холодных стартах".
    - Ограниченные возможности по сложным транзакционным сценариям.

**Решение:**

Выбрана микросервисная архитектура.

**Обоснование:**

 - **Масштабируемость**: архитектура обеспечивает возможность гибкого увеличения количества пользователей и нагрузки без снижения производительности системы.
 - **Надежность**: сбой одного компонента (например, отзывов или уведомлений) не влияет на основные функции бронирования.
 - **Гибкость**: позволяет независимо развивать подсистемы (поиск, оплата, отзывы, аналитика).
 - **Безопасность**: микросервисы обеспечивают изоляцию данных и ролей, что упрощает реализацию принципа наименьших привилегий

**Недостатки решения:**

 - Повышенная сложность DevOps-процессов (CI/CD, мониторинг, трассировка).
 - Необходимость внедрения централизованного логирования, мониторинга.
 - Увеличенное время и стоимость разработки инфраструктурных компонентов.
 - Требуется более опытный DevOps и архитектурный контроль для предотвращения дублирования логики между сервисами.

**Последствия:**

 - Необходимо реализовать систему обмена событиями между сервисами (например, Kafka/RabbitMQ).
 - Каждый микросервис должен иметь собственную базу данных (pattern: Database per Service).
 - Для аутентификации и авторизации будет внедрён сервис Auth Service с поддержкой JWT и OAuth2.
 - Для оркестрации и масштабирования — использование Docker + Kubernetes.
 - Требуется централизованный API Gateway (например, Kong, NGINX API Gateway).
 - Необходимо внедрение observability stack: Prometheus + Grafana + ELK для логов и метрик.
 - Возможна последующая интеграция с системой рекомендаций (Machine Learning service).

